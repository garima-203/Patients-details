<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            border: 1px solid rgb(133, 133, 133);
            padding: 8px;
            text-align: left;
        }

        #spinner {
            display: none; 
            position: fixed;
            top: 50%;
            left: 50%; 
            z-index: 9999;
        }
    </style>
</head>

<body>

    <div id="spinner" class="spinner-border" role="status">         
            <span class="visually-hidden">Loading...</span>
    </div>



    <h1  id="main-heading" class="container mt-3" style="display: none;">Patient Details</h1>
    <div id="table-container" class="container mt-3" style="display: none;">
        <table id="patient-table" class="table table-hover">
            <thead>
                <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Gender</th>
                    <th scope="col">Email</th>
                    <th scope="col">Phone Number</th>
                    <th scope="col">Birth Date</th>
                    <th scope="col">Disease Description</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- Table rows will be inserted here -->
            </tbody>
        </table>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-analytics.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB-Fp38c9GUdO6AekTpdKhwtd6IHg6v-Ns",
            authDomain: "patient-detail-cb679.firebaseapp.com",
            databaseURL: "https://patient-detail-cb679-default-rtdb.firebaseio.com",
            projectId: "patient-detail-cb679",
            storageBucket: "patient-detail-cb679.appspot.com",
            messagingSenderId: "429925058854",
            appId: "1:429925058854:web:03af403cf4a869825559e7",
            measurementId: "G-LLKGNSZ2H5"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const database = getDatabase(app);
        const patientTable = document.getElementById('table-body');
        const spinner = document.getElementById('spinner');
        const mainHeading = document.getElementById('main-heading');
        const tableContainer = document.getElementById('table-container');


        spinner.style.display = 'block';

        onValue(ref(database, 'patients'), (snapshot) => {
            patientTable.innerHTML = '';

            snapshot.forEach((childSnapshot) => {
                const patientData = childSnapshot.val();
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${patientData.name}</td>
                    <td>${patientData.gender}</td>
                    <td>${patientData.email}</td>
                    <td>${patientData.phoneNumber}</td>
                    <td>${patientData.birthDate}</td>
                    <td>${patientData.diseaseDescription}</td>
                `;
                patientTable.appendChild(row);
            });
            spinner.style.display = 'none';
            mainHeading.style.display = 'block';
            tableContainer.style.display = 'block';
        });

    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>